# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ—Å—Å–∏–π –ø—Ä–æ–≥—Ä–µ–≤–∞

**–î–∞—Ç–∞**: 3 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- **–í—Å–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤**: 63
- **‚úÖ –£—á–∞—Å—Ç–≤—É—é—Ç –≤ –ø—Ä–æ–≥—Ä–µ–≤–µ**: 63 (100.0%)
- **‚ùå –ò—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –ø—Ä–æ–≥—Ä–µ–≤–∞**: 0 (0.0%)

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–ª–∞–≥–∞–º:
```
–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ (is_active=0):           0
–£–¥–∞–ª–µ–Ω–Ω—ã–µ (is_deleted=1):           0
–ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ (is_frozen=1):         0
–ó–∞–±–∞–Ω–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞ (–±–µ–∑ unban_date): 0
–í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω (—Å unban_date):       0 ‚úÖ –ì–†–ï–Æ–¢–°–Ø
LLM –æ—Ç–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é:                0
```

---

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø—Ä–æ–≥—Ä–µ–≤–∞:

1. ‚ùå **is_deleted = 1** ‚Üí "session is deleted"
2. ‚ùå **is_frozen = 1** ‚Üí "session is frozen"  
3. ‚ùå **is_banned = 1 AND unban_date IS NULL** ‚Üí "session is banned forever"
4. ‚úÖ **is_banned = 1 AND unban_date IS NOT NULL** ‚Üí **–ì–†–ï–Æ–¢–°–Ø** (–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω)
5. üö´ **llm_generation_disabled = 1** ‚Üí "LLM generation is manually disabled"
6. üí§ **is_active = 0** ‚Üí "session is not active"

### –ö–ª—é—á–µ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
**–í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (—Å unban_date) –†–ê–ó–†–ï–®–ï–ù–´ –¥–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞** - –ø—É—Å—Ç—å –≥—Ä–µ—é—Ç—Å—è!

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                     SESSION FILTERING TESTS                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚úÖ PASSED: should_skip_warmup()     (8/8 —Ç–µ—Å—Ç–æ–≤)
‚úÖ PASSED: get_accounts_for_warmup()

üéâ All tests PASSED!
```

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1. ‚úÖ –û–±—ã—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω–∞
2. ‚úÖ –£–¥–∞–ª–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
3. ‚úÖ –ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
4. ‚úÖ –ë–∞–Ω –Ω–∞–≤—Å–µ–≥–¥–∞ (–±–µ–∑ unban_date) ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
5. ‚úÖ **–í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω (—Å unban_date –≤ –±—É–¥—É—â–µ–º) ‚Üí –†–ê–ó–†–ï–®–ï–ù–ê** ‚≠ê
6. ‚úÖ **–ò—Å—Ç–µ–∫—à–∏–π –±–∞–Ω (unban_date –≤ –ø—Ä–æ—à–ª–æ–º) ‚Üí –†–ê–ó–†–ï–®–ï–ù–ê** ‚≠ê
7. ‚úÖ LLM –æ—Ç–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
8. ‚úÖ –ù–µ–∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

---

## üí∞ –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤ LLM

### –¢–µ–∫—É—â–∞—è —ç–∫–æ–Ω–æ–º–∏—è:
- **–ò—Å–∫–ª—é—á–µ–Ω–æ —Å–µ—Å—Å–∏–π**: 0
- **–≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤ –º–µ—Å—è—Ü**: ~0
- **–≠–∫–æ–Ω–æ–º–∏—è $ –≤ –º–µ—Å—è—Ü**: $0.00

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤):
–ï—Å–ª–∏ —É –≤–∞—Å –±—É–¥—É—Ç –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ/—É–¥–∞–ª–µ–Ω–Ω—ã–µ/–∑–∞–±–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞–≤—Å–µ–≥–¥–∞ —Å–µ—Å—Å–∏–∏:

| –ò—Å–∫–ª—é—á–µ–Ω–æ —Å–µ—Å—Å–∏–π | –ü—Ä–æ–≥—Ä–µ–≤–æ–≤/–¥–µ–Ω—å | –¢–æ–∫–µ–Ω–æ–≤/–º–µ—Å—è—Ü | –≠–∫–æ–Ω–æ–º–∏—è $/–º–µ—Å |
|------------------|----------------|---------------|----------------|
| 5                | 4              | 1,200,000     | $0.17          |
| 10               | 4              | 2,400,000     | $0.34          |
| 20               | 4              | 4,800,000     | $0.67          |
| 50               | 4              | 12,000,000    | $1.68          |

*(DeepSeek: ~$0.14 per 1M tokens)*

---

## üöÄ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd /root/heat_up

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω
pkill -f "python.*main.py" || true

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
./scripts/start.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ uvicorn –Ω–∞–ø—Ä—è–º—É—é
```bash
cd /root/heat_up

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω
pkill -f "uvicorn.*main:app" || true

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å venv –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
source venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8080 --reload
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –í —Ñ–æ–Ω–µ —Å nohup
```bash
cd /root/heat_up
nohup python3 main.py > logs/heat_up.log 2>&1 &
```

---

## üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

### –û—Ç–∫–ª—é—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é LLM –¥–ª—è —Å–µ—Å—Å–∏–∏:
```bash
curl -X PATCH http://localhost:8080/accounts/{account_id} \
  -H "Content-Type: application/json" \
  -d '{"llm_generation_disabled": true}'
```

### –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—É—é –Ω–∞–≤—Å–µ–≥–¥–∞:
```bash
curl -X PATCH http://localhost:8080/accounts/{account_id} \
  -H "Content-Type: application/json" \
  -d '{"is_banned": true, "unban_date": null}'
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω (–≥—Ä–µ–µ—Ç—Å—è):
```bash
curl -X PATCH http://localhost:8080/accounts/{account_id} \
  -H "Content-Type: application/json" \
  -d '{"is_banned": true, "unban_date": "2025-11-10T12:00:00"}'
```

### –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—É—é:
```bash
curl -X PATCH http://localhost:8080/accounts/{account_id} \
  -H "Content-Type: application/json" \
  -d '{"is_frozen": true}'
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –æ–± –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö:
```bash
cd /root/heat_up
python3 scripts/warmup_exclusion_report.py
```

### SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
sqlite3 data/sessions.db "
SELECT 
  COUNT(*) as total,
  SUM(CASE WHEN is_active = 0 THEN 1 ELSE 0 END) as inactive,
  SUM(CASE WHEN is_deleted = 1 THEN 1 ELSE 0 END) as deleted,
  SUM(CASE WHEN is_frozen = 1 THEN 1 ELSE 0 END) as frozen,
  SUM(CASE WHEN is_banned = 1 AND unban_date IS NULL THEN 1 ELSE 0 END) as banned_forever,
  SUM(CASE WHEN is_banned = 1 AND unban_date IS NOT NULL THEN 1 ELSE 0 END) as banned_temp,
  SUM(CASE WHEN llm_generation_disabled = 1 THEN 1 ELSE 0 END) as llm_disabled
FROM accounts;
"
```

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û–±–Ω–æ–≤–ª–µ–Ω—ã:
1. ‚úÖ `database.py` - –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–∞–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã)
2. ‚úÖ `scheduler.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
3. ‚úÖ `main.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ API
4. ‚úÖ `models.py` - –Ω–æ–≤—ã–µ –ø–æ–ª—è
5. ‚úÖ `scripts/test_session_filtering.py` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã

### –°–æ–∑–¥–∞–Ω—ã:
1. ‚úÖ `docs/guides/SESSION_FILTERING_GUIDE.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
2. ‚úÖ `scripts/warmup_exclusion_report.py` - –æ—Ç—á–µ—Ç –æ–± –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö
3. ‚úÖ `SESSION_FILTERING_CHANGELOG.md` - changelog
4. ‚úÖ `WARMUP_FILTERING_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ë–î –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ scheduler –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π LLM –ø–ª–∞–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –±–∞–Ω—ã –ù–ï –±–ª–æ–∫–∏—Ä—É—é—Ç –ø—Ä–æ–≥—Ä–µ–≤
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å (–∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç: `curl http://localhost:8080/health`
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ß—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è:
- ‚ùå –ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ (is_frozen)
- ‚ùå –£–¥–∞–ª–µ–Ω–Ω—ã–µ (is_deleted)
- ‚ùå –ó–∞–±–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞–≤—Å–µ–≥–¥–∞ (is_banned –±–µ–∑ unban_date)
- ‚ùå LLM –æ—Ç–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é (llm_generation_disabled)
- ‚ùå –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ (is_active=0)

### –ß—Ç–æ –†–ê–ó–†–ï–®–ï–ù–û:
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã–µ (is_banned —Å unban_date) ‚≠ê
- ‚úÖ –í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏

---

**–°—Ç–∞—Ç—É—Å**: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞, –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞.  
**–î–µ–π—Å—Ç–≤–∏–µ**: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

