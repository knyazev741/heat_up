# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ Admin API

## ‚úÖ –¢–µ–ø–µ—Ä—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

–í–∞–º **–ù–ï –ù–£–ñ–ù–û** –∑–∞–ø—É—Å–∫–∞—Ç—å `sync_session_statuses.py` –≤—Ä—É—á–Ω—É—é. –°–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞
–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ scheduler –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–Ω–∞—á–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é** —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ Admin API.

### 2. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
–ö–∞–∂–¥—ã–µ **24 —á–∞—Å–∞** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è) scheduler –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –ü—Ä–æ—à–ª–æ –ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ï—Å–ª–∏ –¥–∞ - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∏–∑ Admin API
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í `config.py` (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ `.env`):

```python
admin_sync_enabled: bool = True           # –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
admin_sync_interval_hours: int = 24      # –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—á–∞—Å—ã)
```

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–í–∞—Ä–∏–∞–Ω—Ç 1:** –ò–∑–º–µ–Ω–∏—Ç—å –≤ `config.py`:
```python
admin_sync_interval_hours: int = 12  # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤
```

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –î–æ–±–∞–≤–∏—Ç—å –≤ `.env`:
```bash
ADMIN_SYNC_INTERVAL_HOURS=12
```

### –ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

**–í–∞—Ä–∏–∞–Ω—Ç 1:** –í `config.py`:
```python
admin_sync_enabled: bool = False
```

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –í `.env`:
```bash
ADMIN_SYNC_ENABLED=false
```

## üìä –ß—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

1. **Frozen —Å–µ—Å—Å–∏–∏** (`is_frozen = 1`)
2. **Deleted —Å–µ—Å—Å–∏–∏** (`is_deleted = 1`)
3. **Banned forever —Å–µ—Å—Å–∏–∏** (`is_banned = 1`, `unban_date = NULL`)

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

```
üîÑ Performing initial Admin API sync...
‚úÖ Initial sync completed: 436 frozen, 14588 deleted, 348 banned forever

...

üîÑ Last sync was 24.1h ago (interval: 24h) - syncing...
‚úÖ Sync completed: 436 frozen, 14588 deleted, 348 banned forever
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–í –ë–î —Å–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `sync_metadata` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```sql
SELECT * FROM sync_metadata WHERE key = 'last_admin_sync';
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–û—Å—Ç–∞–≤—å—Ç–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (24 —á–∞—Å–∞)** - —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ API
2. **–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å—ã –º–µ–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ** - –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 12 —á–∞—Å–æ–≤
3. **–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å—ã –º–µ–Ω—è—é—Ç—Å—è —Ä–µ–¥–∫–æ** - –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 48 —á–∞—Å–æ–≤
4. **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ `.env`

## üîß –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –≤—Å–µ-—Ç–∞–∫–∏ –Ω—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):

```bash
python3 sync_session_statuses.py
```

–ù–æ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —ç—Ç–æ **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** - —Å–∏—Å—Ç–µ–º–∞ —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ:
- –°–∫–æ–ª—å–∫–æ frozen —Å–µ—Å—Å–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
- –°–∫–æ–ª—å–∫–æ deleted —Å–µ—Å—Å–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ  
- –°–∫–æ–ª—å–∫–æ banned forever —Å–µ—Å—Å–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## ‚úÖ –ò—Ç–æ–≥–æ

‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è**  
‚úÖ **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 24 —á–∞—Å–∞)  
‚úÖ **–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**  
‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞**  
‚úÖ **–í—Å–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è**  

**–ù–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ - –ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–π—Ç–µ!** üéâ

